<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Untitled</title>
        <link href="//fonts.googleapis.com/css?family=Raleway:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic|Crete+Round:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic|Lato:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic|Playfair+Display:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic|Oxygen:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic|Crete+Round:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
        <link rel="stylesheet" id="ls-google-fonts-css" href="http://fonts.googleapis.com/css?family=Lato:100,300,regular,700,900%7COpen+Sans:300%7CIndie+Flower:regular%7COswald:300,regular,700&amp;subset=latin%2Clatin-ext" type="text/css" media="all">
        <link rel="stylesheet" href="http://tinywhalecreative.com/new/wp-content/themes/stockholm/css/stylesheet.min.css?ver=4.0.1">
        <link rel="stylesheet" id="qode_style_dynamic-css" href="http://tinywhalecreative.com/new/wp-content/themes/stockholm/css/style_dynamic.css?ver=1421594068" type="text/css" media="all">
        <link rel="stylesheet" href="http://tinywhalecreative.com/new/wp-content/themes/stockholm-child/style.css?ver=4.0.1">
        <link rel="stylesheet" href="joke-styles.css">

        <link rel="author" href="humans.txt">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.15.0/TweenLite.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.15.0/TimelineLite.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.15.0/plugins/CSSPlugin.min.js"></script>

		<script type="text/javascript">
		$(document).ready(function(){

			(function() {
				//utility: shuffle joke order for every page reload
				var clickCount = 0;
				var clickLimit = 8;
				var jokes;

				function shuffleArray(array) {
			      for (var i = array.length - 1; i > 0; i--) {
				      var j = Math.floor(Math.random() * (i + 1));
				      var temp = array[i];
				      array[i] = array[j];
				      array[j] = temp;
			      }
			      return array;
			    }
			    //utility: get random number within a range
			    function getRandomInt (min, max) {
				    return Math.floor(Math.random() * (max - min + 1)) + min;
				}

				//get jokes
				$.getJSON( "jokes.json", {
				    question: "question",
				    button: "button",
				    answer: "answer"
				  })
				  .done(function( data ) {
  				    jokes = shuffleArray(data);
				    runJokes();
				  });

				//set up page
				function runJokes() {
					if (clickCount>clickLimit){
						if( bubbleTl ){
							bubbleTl.remove();
							$("#bubble_one").remove();
							$("#bubble_two").remove();
							$("#bubble_three").remove();
						}
						$(".container").empty().append("<div id='end_message'><h1>Wow, you really like jokes!</h1><p class='final'>Or you kept clicking hoping they’d get funnier. Either way, we have a feeling we’d get along pretty well. <span id='obf'>Give us a shout</span> if you want to talk about some (more serious) business, we’d love to hear from you.</p></div>");

						document.getElementById('obf').innerHTML="<n uers=\"znvygb:uryyb@gvaljunyrperngvir.pbz?fhowrpg=Uryyb\" >Tvir hf n fubhg</n>"
						.replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);});

						var tlEnd = new TimelineLite();
						tlEnd.to("#end_message", 1, {opacity: "1"}, "-=.75");
						tlEnd.to("#walrus_image", .5, {opacity: "1", height: "336px"});

					}else{
						var joke = jokes[clickCount]; 
			    		
			    		var tl = new TimelineLite();
			    		var tlClick = new TimelineLite();

						$(".question h2 span").text(joke["question"]);
						tl.to(".answer.button", 0, {display: "inline-block"});
						tl.to(".question h2 span", .5, {opacity: "1"});
			    		tl.to(".answer.button", .5, {opacity: "1"});

						//populate markup with data
					    $(".answer.button").text(joke["button"]);
					    $(".answer_block h3").text(joke["answer"]);

					    $(".answer.button").on("click", function(){
					    	$(this).off();
					    	tlClick.to(this, .25, {opacity: "0"});
					    	tlClick.to(this, 0, {display: "none"});
						    tlClick.to(".answer_block h3", .25, {opacity: "1"});
							tlClick.to(".one_more", .25, {opacity: "1"});
							tlClick.call(function(){$(".one_more").on("click", getAnotherJoke );});
						    })
						 };
					};
					function getAnotherJoke(event){
						console.log("get another joke called");
			    		++clickCount;
			    		var tl = new TimelineLite();
			    		$(".one_more").off();
			    		tl.to(".one_more", .25, {opacity:"0"});
			    		tl.to(".question h2 span", .0, {opacity:"0"});
			    		tl.to(".answer_block h3", .0, {opacity:"0"});
			    		tl.call(runJokes);
			    	};

			    	// bubble animation
					var bubbleTl = new TimelineLite({  onStart: bubblePositionSetup});
					bubbleTl.to("#bubble_one", 0, {opacity: 1});
					bubbleTl.to("#bubble_one", 4, {bottom: "90%", opacity: 0, ease:Linear.easeNone});
					bubbleTl.to("#bubble_two", 0, {opacity: 1});
					bubbleTl.to("#bubble_two", 4, {bottom: "90%", opacity: 0, ease:Linear.easeNone});	
					bubbleTl.to("#bubble_three", 0, {opacity: 1});
					bubbleTl.to("#bubble_three", 4, {bottom: "90%", opacity: 0, ease:Linear.easeNone});	
					bubbleTl.call(function()
						{  if (clickCount<jokes.length){
								bubbleTl.restart();
							}else{
								console.log("we're at the end");
							} 
						});
						
					function bubblePositionSetup(){
						//randomize the left position of bubbles
						var random = function(a, b){ return getRandomInt(a, b) + "%"; };
						$("#bubble_one").css({"left": random(5, 15)});
						$("#bubble_two").css({"left": random(70, 80), "opacity": 0});
						$("#bubble_three").css({"left": random(80, 90), "opacity": 0});
					}
				})();


			
		});

		</script>
    </head>
    <body>
<!--     <div class="outer_wrap">
 -->		   <div class="page_wrap">
		    <div class="full_width">
				<div class="container">
						<div class="vc_row wpb_row section vc_row-fluid grid_section">
							<div class="joke">
								<div class="question">
									<h2><span></span></h2>
								</div>
							</div>
						</div>
						<div class="vc_row wpb_row section vc_row-fluid grid_section joke_section">
							<div class="answer_button_container">
								<div class="answer button qbutton"></div>
								<div class="answer_block">
									<h3></h3>
								</div>
							</div>
							<div class="vc_row wpb_row section vc_row-fluid grid_section new_joke">	
								<h4 class="one_more">Next Joke ></h4>					
							</div>
						</div>
				</div>
				<div id="walrus"><div id="walrus_image"></div></div>
			</div>
		</div>

		<footer class="footer footer_border_columns">
			<div class="footer_inner clearfix">
				<div class="footer_bottom_holder">
					<div class="footer_top_border_holder in_grid" style="height: 1px;background-color: #d5d5d5;"></div>
					<div class="footer_bottom">
						
		<span id="obf" class="qbutton contact"><script>document.getElementById("obf").innerHTML="<n uers=\"znvygb:uryyb@gvaljunyrperngvir.pbz?fhowrpg=Uryyb\">Pbagnpg Hf</n>".replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);});</script>
		<noscript><span style="unicode-bidi:bidi-override;direction:rtl;">moc.evitaercelahwynit@olleh</span></noscript></span>
						<div class="textwidget logo">
						<a href="http://www.tinywhalecreateive.com"><img src="tw_gray.png" height="26" width="200" alt="logo"></a>
					</div>
					<img width="50" height="50" src="anchor.png" class=" vc_box_border_grey attachment-thumbnail" alt="anchor">
				</div>
			</div>
			</div>
		</footer>
		<div id="bubble_one"></div>
		<div id="bubble_two"></div>
		<div id="bubble_three"></div>	
<!-- 		</div>
 -->   </body>
</html>